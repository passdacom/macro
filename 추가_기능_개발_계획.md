# 고급 매크로 추가 기능 개발 계획

## 개요

안정화된 v2.0 버전을 기반으로, 사용 편의성과 프로그램의 활용도를 극대화하기 위한 고급 기능들을 단계적으로 추가한다. 모든 기능 추가 과정에서 기존 코드의 안정성을 해치지 않도록 신중하게 접근하며, 각 단계별로 철저한 테스트를 거친다.

---

## 1. 매크로 편집기 (Priority: Highest)

*   **목표:** 사용자가 녹화된 매크로의 내용을 GUI에서 직접 확인하고, 불필요한 단계를 삭제하거나 시간 지연(딜레이)을 수정할 수 있도록 하여 매크로 제작의 유연성을 극대화한다.
*   **세부 실행 계획:**
    1.  **GUI 레이아웃 변경:** `app_gui.py`에 `tkinter.ttk.Treeview` 위젯을 추가하여 이벤트 목록을 표시할 표를 생성한다. 표의 컬럼은 `단계`, `시간`, `이벤트 종류`, `상세 정보` 등으로 구성한다.
    2.  **데이터 연동:** 녹화가 끝나거나 파일을 불러왔을 때, `macro_data`의 이벤트 목록을 `Treeview`에 자동으로 채워 넣는 `_populate_treeview` 함수를 구현한다.
    3.  **삭제 기능 구현:** `Treeview`에서 특정 이벤트를 선택한 후 누를 수 있는 "선택 항목 삭제" 버튼을 추가한다. 이 버튼은 `macro_data` 리스트에서 해당 이벤트를 실제로 삭제하고, `Treeview`를 새로고침하는 기능을 수행한다.
    4.  **(추후 확장) 시간 수정 기능:** 사용자가 `Treeview`의 시간 값을 더블 클릭하면, 해당 값을 수정할 수 있는 입력 필드를 띄워주는 기능을 구현한다.

---

## 2. 재생 속도 조절 (Priority: Medium)

*   **목표:** 매크로 재생 속도를 조절하는 기능을 추가하여, 단순 반복 작업은 빠르게, 타이밍이 중요한 작업은 느리게 실행할 수 있도록 한다.
*   **세부 실행 계획:**
    1.  **GUI 요소 추가:** `app_gui.py`에 재생 속도를 선택할 수 있는 슬라이더 또는 스핀박스 (e.g., 0.5x, 1.0x, 1.5x, 2.0x)를 추가한다.
    2.  **재생 로직 수정:** `event_player.py`의 `_play_events_task` 함수가 GUI에서 설정된 속도 값을 인자로 받도록 수정한다.
    3.  함수 내부에서 이벤트 사이의 대기 시간(`time.sleep`)을 속도 값에 맞춰 동적으로 조절한다. (예: `wait_time / speed_multiplier`)

---

## 3. 이미지 서치 (Priority: Low - High Complexity)

*   **목표:** 고정된 좌표가 아닌, 화면에서 특정 이미지를 찾아 클릭하는 기능을 추가하여 매크로의 안정성과 활용도를 혁신적으로 높인다.
*   **세부 실행 계획:**
    1.  **라이브러리 추가:** `pyautogui` 또는 `opencv-python` 라이브러리를 `requirements.txt`에 추가하고 설치한다.
    2.  **GUI 기능 추가:** "이미지 캡처" 버튼을 추가한다. 사용자가 이 버튼을 누르면 화면의 특정 영역을 드래그하여 선택하고, 해당 영역이 이미지 파일로 저장되도록 한다.
    3.  **새로운 이벤트 타입 정의:** `ImageSearchClickEvent`와 같은 커스텀 이벤트를 정의한다.
    4.  **녹화/재생 로직 수정:** 녹화기는 이미지 캡처 시 이 커스텀 이벤트를 기록하고, 재생기는 이 이벤트를 만나면 `pyautogui.locateCenterOnScreen()` 등의 함수로 화면에서 해당 이미지를 찾아 좌표를 얻어낸 후 클릭을 수행한다.

---

## 4. 사용자 편의 기능 (Quality of Life)

*   **목표:** 프로그램의 상태를 명확히 알리고, 백그라운드 실행을 지원하는 등 소소하지만 체감 만족도를 높이는 기능들을 추가한다.
*   **세부 실행 계획:**
    1.  **상태 표시줄:** GUI 최하단에 현재 프로그램의 상태(e.g., "준비", "녹화 중...", "재생 완료")를 알려주는 `Label` 위젯을 추가한다.
    2.  **시스템 트레이 최소화:** 창을 닫을 때 완전히 종료하는 대신, 시스템 트레이 아이콘으로 최소화되어 백그라운드에서 단축키를 계속 수신 대기하는 옵션을 제공한다. `pystray` 라이브러리 사용을 고려한다.
    3.  **항상 위 옵션:** 프로그램 창을 다른 모든 창 위에 고정시키는 체크박스 옵션을 추가한다. (`root.attributes("-topmost", True)`)